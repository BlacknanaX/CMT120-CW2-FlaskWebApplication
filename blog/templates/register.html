{% extends 'base/base.html' %}
{% block title %}Register{% endblock %}


{% block content %}
    <div class="container">
        <div class="page-header">
            <h1>Register</h1>
        </div>
        <div class="panel-body">
            {% for message in get_flashed_messages(category_filter="logout") %}
                <div class="alert alert-success">
                    <button type="button" class="close" data-dismiss="alert">&times;</button>
                    {{ message }}
                </div>
            {% endfor %}
            <form class="form-horizontal" role="form" method="post">
                {{ form.hidden_tag() }}
                <div class="form-group">
                    {{ form.username.label() }}
                    <div class="input-group ">
                        <span class="input-group-addon">
                            <span class="glyphicon glyphicon-user"></span>
                        </span>
                        {{ form.username(id='first_name_new', class='form-control') }}
                    </div>
                </div>
                <div class="form-group">
                    {{ form.email.label() }}
                    <div class="input-group ">
                        <span class="input-group-addon">
                            <span class="glyphicon glyphicon-envelope"></span>
                        </span>
                        {{ form.email(id='email_new', class='form-control') }}
                    </div>
                </div>
                <div class="form-group">
                    {{ form.password.label() }}
                    {{ form.password(id='password_new', class='form-control') }}
                </div>
                <div class="form-group">
                    {{ form.confirm_password.label() }}
                    {{ form.confirm_password(id='password_confirm', class='form-control') }}
                </div>
                <div class="form-group">
                    {{ form.submit(class='btn btn-default') }}
                </div>
            </form>
        </div>
    </div>
    {{ super() }}
{% endblock content %}

{% block scripts %}
    {{ super() }}
    <script type="text/javascript">
        $(document).ready(function () {
            $('#first_name_new').keypress(function () {
                if ($('#first_name_new').val().length === 20) {
                    $('#first_name_new').parents('.form-group').addClass('has-error').append('<msg class="msg">\n' +
                        '<p>Field cannot be longer than 20 characters</p>\n' +
                        '</msg>');
                }
            });
            $('#password_new').keypress(function () {
                if ($('#password_new').val().length === 20) {
                    $('#password_new').parents('.form-group').addClass('has-error').append('<msg class="msg">\n' +
                        '<p>Field cannot be longer than 20 characters</p>\n' +
                        '</msg>');
                }
            })
            {% if form.errors.username %}
                $('#first_name_new').parents('.form-group').addClass('has-error').append('<msg class="msg">\n' +
                    '{% for msg in form.errors.username %}<p>{{ msg }}</p>{% endfor %}\n' +
                    '</msg>');
            {% else %}
                $('#first_name_new').parents('.form-group').removeClass('has-error').remove('.msg');
            {% endif %}
            {% if form.errors.email %}
                $('#email_new').parents('.form-group').addClass('has-error').append('<msg class="msg">\n' +
                    '{% for msg in form.errors.email %}<p>{{ msg }}</p>{% endfor %}\n' +
                    '</msg>');
            {% else %}
                $('#email_new').parents('.form-group').removeClass('has-error').remove('.msg');
            {% endif %}
            {% if form.errors.password %}
                $('#password_new').parents('.form-group').addClass('has-error').append('<msg class="msg">\n' +
                    '{% for msg in form.errors.password %}<p>{{ msg }}</p>{% endfor %}\n' +
                    '</msg>');
            {% else %}
                $('#password_new').parents('.form-group').removeClass('has-error').remove('.msg');
            {% endif %}
            {% if form.errors.confirm_password %}
                $('#password_confirm').parents('.form-group').addClass('has-error').append('<msg class="msg">\n' +
                    '{% for msg in form.errors.confirm_password %}<p>{{ msg }}</p>{% endfor %}\n' +
                    '</msg>');
            {% else %}
                $('#password_confirm').parents('.form-group').removeClass('has-error').remove('.msg');
            {% endif %}
        });
    </script>
{% endblock scripts %}
